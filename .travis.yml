---
language: bash

# Tell Travis to start Docker when it brings up an environment.
services:
  - docker

env:
  global: []
  matrix:
    # Provide a list of GLPI version to build
    - GLPI_VERSION=""
    - GLPI_VERSION=9.1.3

script:
  - export VCS_REF=$(if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then echo $TRAVIS_COMMIT; else echo $TRAVIS_PULL_REQUEST_SHA; fi)

  # 
  # Build docker image
  #
  - ${PWD}/build.sh

  #
  ## Run tests
  #

  #
  # Deploy
  #
  - '[ "$TRAVIS_PULL_REQUEST" == "false" ] || exit 0'
  - '[ "$TRAVIS_SECURE_ENV_VARS" == "true" -a  -n "$DOCKERHUB_REGISTRY_USERNAME" -a -n "$DOCKERHUB_REGISTRY_PASSWORD" ]'
  - echo "$DOCKERHUB_REGISTRY_PASSWORD" | docker login --username="$DOCKERHUB_REGISTRY_USERNAME" --password-stdin
